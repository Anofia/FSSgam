### FSSgam
Consists of two functions: full.subsets.gam and check.correlations
requires: doParallel, MuMIn, gamm4, mgcv, nnet

### arguments ################################################################
 
A dataframe, with columns matching those included in pred.vars.cont and pred.vars.fact, the response variable to be analysed and any other fields required for the analysis (such as random effects, see test.fit).
A gam model fitted via a call to gam (mgcv) uGamm (MuMIn). This can use any of the (preferably continuous) predictors in the call and will be used as a model to update in the fitting of the model set. The test fit must contain the appropriate random effects and call to family (if not gaussian) and if gamm4 should be used, or gamm in the case of a uGamm call (see ?uGamm).
A character vector indicating the continuous predictors to use. By default all continuous predictors will be fitted using a smoother (but see argument linear.vars). These must match column names in use.dat exactly. More than one continuous smooth predictor must be supplied to run the full.subsets.gam function.
NA if there are no factor predictors, or a character vector indicating the factor predictors to use. These must match column names in use.dat exactly. All pred.vars.fact variables will be coerced to a factor, with unused levels simultaneously dropped via a call to factor. By default all factor variables will be included as interactions with the continuous smoothers via their specification as a by argument in the call to gam (but see smooth.interactions). Factor interactions are not included by default (but see factor.interactions).
NA if there are no cyclic predictors, or if there are cyclic predictors,a character vector containing the names of any of the continuous predictors that should be modelled as cyclic variables. Note that these must also be contained in the pred.vars.cont charactervector. Please also note there are issues with bs='cc' and model selection as this uses by default shrinkage. With shrinkage, variables are retained in models but with zero edf, which makes interpretation of AICc and BIC confusing. To account for this always select only the most parsimonious model (that with the fewest parameters), not just that with the lowest AICc. Reported estimated degrees of freedom (edf) in the model output table represent the sum of the edf of the smooth terms plus the number of parametric coefficients. When cyclic variables are included and shrinkage is used, any estimated edf of the smooth terms that are less than 1 are reset to 1 before summing to ensure the the total number of predictors in the model is captured properly.
NA if there are no continuous predictors you which to treat as linear (not smooths). Only use this where variables are clearly continuous in nature, but you are confident a linear relationship is valid. It may also be useful for continuous predictors are not well distributed along the x-axis (ie, sampling was conducted in clumped distances from a feature of interest). Where this is necessary, transformations should be considered where they can be used to theoretical "linearize" response relationships.
An integer indicating the maximum model size to fit (ie the maximum number of predictors to include in any one model). 
A numeric value between 0 and 1 indicating the covariance cutoff value to use for excluding collinear models. T default value is 0.28 (see Graham MH (2003). It is highly recommended to keep this value low, as correlation among predictors can yield spurious results. Note that predictors with a correlation greater than the specified value will still appear in the model set but will never appear in the same model. Including highly correlated predictors can make interpreting variable importance values difficult. Estimates of all correlations are based on the included function check.correlations which provides estimates for correlations between all continuous predictors (via a call to cor), continuous predictors and factors (via a call to lm) as well as between all factors and other factors (via a call to multinom).
An integer indicating the dimension of the basis used to represent the smooth term (see ?s). The default value is 5. Higher values are not recommended unless a complex trend between the response variable and the continuous predictor variables is expected, and the data are sufficient to support this. k can be reduced to as low as 3 where there is trouble obtaining convergence, or sample size is low. Note that this must be set to override the default value, regardless of what k is used in the test.fit
A logical value indicating if parallel processing should be used. The default is FALSE. Before changing to TRUE, please make sure parallel processing works for you by runing the code: cl=makePSOCKcluster(2); registerDoParallel(cl)
The number of cores to use in the parallel processing when parallel is set to T. The default value is 4, which is suitable for most current quad core machines.
The weights vector to use for passing n trials in a binomial call. The default of rep(1,nrow(use.dat)) is included for coding convenience. 
A character vector indicating the form of any re smooths to be included in gam [e.g. "s(site,bs='re')"] or any other fixed terms or smooths that the user wants to include in the null model. Use of bs="re" is an alternative way of fitting simple random structures that avoids use of PQL and allows a the greater range of families available in gam.mgcv to be used. see ?s and links therein. Note: make sure you use "gam" instead of uGamm to make sure PQL is not used.
Specification of the smoother to use, see ?s for more information on smoother provided in gam (mgcv). Note that all continuous predictors specified in pred.vars.cont will be fitted using the same smooth, unless they are also specified as linear.terms or cyclic.vars. Note that any specification of bs in test.fit is discarded.
A character vector specifying if/which factor variables should be included as "by" argument interaction terms with the continuous predictors. Default is the list of pred.vars.fact, meaning that all will be included by default, otherwise only those included in the character vector will be added. Note that specified factors must also be included in pred.vars.fact. If specified as NA no factor interactions will be included.
A logical value indicating if interactions between factors should be included. Default is 'F'. Note that this can massively increase the number of models in the candidate set. Not recommended when there are factors with many levels.
The total number of models allowed to be fit. If the candidate set is bigger than this value, an error message will be returned, asking the user to reset this to a larger value.
The value to extract from the gam model fit to use as the R squared value. Defaults to "r2.lm.est" which returns and estimated R squared value based on a linear regression between the observed and predicted values. "r2" will return the adjusted R.sq as reported by gam, gamm or gamm4."dev" will return the deviance explained as reported by gam or gamm. Note gamm4 does not currently return a deviance.
The estimated null model R2 is subtracted from each model R2 to give an idea of the unique variance explained. This can be useful where null terms are included in the model set.

### known issues
This function assumes you know what you are doing. Non-gaussian mixed model
gamm resorts to PQL meaning that AICc calls will not return the AIC of the
actual model. Please thoroughly read the help files contained within the gamm4
and mgcv packages, including information under details.

